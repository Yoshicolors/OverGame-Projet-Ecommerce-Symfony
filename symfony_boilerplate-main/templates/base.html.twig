<!DOCTYPE html>
<html lang="{{ app.request.locale }}">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>{% block title %}OverGame - {{ 'nav.home'|trans }}{% endblock %}</title>
        <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 128 128%22><text y=%221.2em%22 font-size=%2296%22>ðŸŽ®</text></svg>">
        
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+JP:wght@400;500;700&family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
        
        {% block stylesheets %}
            <style>
                * {
                    font-family: 'Inter', 'Noto Sans JP', 'Noto Sans KR', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
                    margin: 0;
                    padding: 0;
                    box-sizing: border-box;
                }
                
                body {
                    background: #f5f7fa;
                    color: #2d3748;
                    min-height: 100vh;
                }

                /* Navigation */
                .main-nav {
                    background: white;
                    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
                    position: sticky;
                    top: 0;
                    z-index: 100;
                }

                .nav-container {
                    max-width: 1400px;
                    margin: 0 auto;
                    padding: 0 20px;
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    height: 70px;
                }

                .nav-logo {
                    font-size: 24px;
                    font-weight: 700;
                    color: #667eea;
                    text-decoration: none;
                    display: flex;
                    align-items: center;
                    gap: 8px;
                }

                .nav-links {
                    display: flex;
                    align-items: center;
                    gap: 30px;
                    list-style: none;
                }

                .nav-links a {
                    color: #2d3748;
                    text-decoration: none;
                    font-weight: 500;
                    transition: color 0.3s;
                }

                .nav-links a:hover {
                    color: #667eea;
                }

                .nav-actions {
                    display: flex;
                    align-items: center;
                    gap: 15px;
                }

                .btn-nav {
                    padding: 8px 20px;
                    border-radius: 6px;
                    text-decoration: none;
                    font-weight: 600;
                    font-size: 14px;
                    transition: all 0.3s;
                }

                .btn-primary {
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    color: white;
                }

                .btn-primary:hover {
                    transform: translateY(-2px);
                    box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
                }

                .btn-secondary {
                    background: #f7fafc;
                    color: #2d3748;
                    border: 2px solid #e2e8f0;
                }

                .btn-secondary:hover {
                    background: #edf2f7;
                }

                .user-menu {
                    position: relative;
                    display: inline-block;
                }

                .user-button {
                    display: flex;
                    align-items: center;
                    gap: 8px;
                    padding: 8px 16px;
                    background: #f7fafc;
                    border: 2px solid #e2e8f0;
                    border-radius: 6px;
                    cursor: pointer;
                    font-weight: 600;
                    color: #2d3748;
                }

                .user-button:hover {
                    background: #edf2f7;
                }

                .user-dropdown {
                    display: none;
                    position: absolute;
                    top: 100%;
                    right: 0;
                    margin-top: 8px;
                    background: white;
                    border-radius: 8px;
                    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                    min-width: 200px;
                    overflow: hidden;
                }

                .user-menu:hover .user-dropdown {
                    display: block;
                }

                .user-dropdown a {
                    display: block;
                    padding: 12px 20px;
                    color: #2d3748;
                    text-decoration: none;
                    transition: background 0.2s;
                }

                .user-dropdown a:hover {
                    background: #f7fafc;
                }

                .user-dropdown .divider {
                    height: 1px;
                    background: #e2e8f0;
                    margin: 8px 0;
                }

                /* SÃ©lecteur de langue */
                .language-switcher {
                    position: fixed;
                    top: 80px;
                    right: 20px;
                    z-index: 90;
                }
                
                .language-dropdown {
                    position: relative;
                    display: inline-block;
                }
                
                .language-current {
                    display: flex;
                    align-items: center;
                    gap: 8px;
                    padding: 10px 15px;
                    background: white;
                    color: #2d3748;
                    border: 2px solid #e2e8f0;
                    border-radius: 8px;
                    cursor: pointer;
                    font-weight: 600;
                    font-size: 14px;
                    transition: all 0.3s;
                    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
                }
                
                .language-current:hover {
                    background: #f7fafc;
                }
                
                .language-current::after {
                    content: 'â–¼';
                    font-size: 10px;
                    margin-left: 5px;
                }
                
                .language-menu {
                    display: none;
                    position: absolute;
                    top: 100%;
                    right: 0;
                    margin-top: 5px;
                    background: white;
                    border-radius: 8px;
                    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                    min-width: 180px;
                    overflow: hidden;
                }
                
                .language-dropdown:hover .language-menu {
                    display: block;
                }
                
                .language-menu a {
                    display: flex;
                    align-items: center;
                    gap: 10px;
                    padding: 12px 15px;
                    color: #333;
                    text-decoration: none;
                    transition: background 0.2s;
                    font-size: 14px;
                }
                
                .language-menu a:hover {
                    background: #f0f0f0;
                }
                
                .language-menu a.active {
                    background: #e7f3ff;
                    color: #007bff;
                    font-weight: 600;
                }
                
                .language-flag {
                    font-size: 20px;
                }

                /* Messages Flash */
                .flash-messages {
                    position: fixed;
                    top: 80px;
                    left: 50%;
                    transform: translateX(-50%);
                    z-index: 1000;
                    width: 90%;
                    max-width: 600px;
                }

                .alert {
                    padding: 16px 20px;
                    border-radius: 8px;
                    margin-bottom: 10px;
                    font-weight: 500;
                    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
                    animation: slideDown 0.3s ease;
                }

                @keyframes slideDown {
                    from {
                        opacity: 0;
                        transform: translateY(-20px);
                    }
                    to {
                        opacity: 1;
                        transform: translateY(0);
                    }
                }

                .alert-success {
                    background: #c6f6d5;
                    color: #22543d;
                }

                .alert-error {
                    background: #fed7d7;
                    color: #742a2a;
                }

                .alert-info {
                    background: #bee3f8;
                    color: #2c5282;
                }

                .alert-warning {
                    background: #feebc8;
                    color: #7c2d12;
                }

                @media (max-width: 768px) {
                    .nav-links {
                        display: none;
                    }
                }
            </style>
        {% endblock %}

        {% block javascripts %}
            {% block importmap %}{{ importmap('app') }}{% endblock %}
        {% endblock %}
    </head>
    <body>
        {# Navigation principale #}
        <nav class="main-nav">
            <div class="nav-container">
                <a href="{{ path('app_home') }}" class="nav-logo">
                    ðŸŽ® OverGame
                </a>

                <ul class="nav-links">
                    <li><a href="{{ path('app_product_index') }}">{{ 'nav.catalog'|trans }}</a></li>
                    {% if app.user %}
                        <li><a href="{{ path('app_order_index') }}">{{ 'order.my_orders'|trans }}</a></li>
                    {% endif %}
                </ul>

                <div class="nav-actions">
                    <a href="{{ path('app_cart_index') }}" class="btn-nav btn-secondary">
                        ðŸ›’ {{ 'nav.cart'|trans }}
                    </a>

                    {% if app.user %}
                        <div class="user-menu">
                            <button class="user-button">
                                <span>ðŸ‘¤</span>
                                <span>{{ app.user.firstName }}</span>
                            </button>
                            <div class="user-dropdown">
                                <a href="{{ path('app_order_index') }}">{{ 'order.my_orders'|trans }}</a>
                                {% if is_granted('ROLE_ADMIN') %}
                                    <div class="divider"></div>
                                    <a href="{{ path('app_admin_dashboard') }}">{{ 'nav.admin'|trans }}</a>
                                {% endif %}
                                <div class="divider"></div>
                                <a href="{{ path('app_logout') }}">{{ 'auth.logout_button'|trans }}</a>
                            </div>
                        </div>
                    {% else %}
                        <a href="{{ path('app_login') }}" class="btn-nav btn-primary">
                            {{ 'auth.login_button'|trans }}
                        </a>
                    {% endif %}
                </div>
            </div>
        </nav>

        {# SÃ©lecteur de langue #}
        <div class="language-switcher">
            <div class="language-dropdown">
                <button class="language-current">
                    <span class="language-flag">
                        {% if app.request.locale == 'fr' %}ðŸ‡«ðŸ‡·
                        {% elseif app.request.locale == 'en' %}ðŸ‡¬ðŸ‡§
                        {% elseif app.request.locale == 'de' %}ðŸ‡©ðŸ‡ª
                        {% elseif app.request.locale == 'ja' %}ðŸ‡¯ðŸ‡µ
                        {% elseif app.request.locale == 'ko' %}ðŸ‡°ðŸ‡·
                        {% else %}ðŸ‡«ðŸ‡·{% endif %}
                    </span>
                    <span>
                        {% if app.request.locale == 'fr' %}FR
                        {% elseif app.request.locale == 'en' %}EN
                        {% elseif app.request.locale == 'de' %}DE
                        {% elseif app.request.locale == 'ja' %}JA
                        {% elseif app.request.locale == 'ko' %}KO
                        {% else %}FR{% endif %}
                    </span>
                </button>
                <div class="language-menu">
                    <a href="{{ path('app_change_locale', {locale: 'fr'}) }}" 
                       class="{{ app.request.locale == 'fr' ? 'active' : '' }}">
                        <span class="language-flag">ðŸ‡«ðŸ‡·</span>
                        <span>FranÃ§ais</span>
                    </a>
                    <a href="{{ path('app_change_locale', {locale: 'en'}) }}" 
                       class="{{ app.request.locale == 'en' ? 'active' : '' }}">
                        <span class="language-flag">ðŸ‡¬ðŸ‡§</span>
                        <span>English</span>
                    </a>
                    <a href="{{ path('app_change_locale', {locale: 'de'}) }}" 
                       class="{{ app.request.locale == 'de' ? 'active' : '' }}">
                        <span class="language-flag">ðŸ‡©ðŸ‡ª</span>
                        <span>Deutsch</span>
                    </a>
                    <a href="{{ path('app_change_locale', {locale: 'ja'}) }}" 
                       class="{{ app.request.locale == 'ja' ? 'active' : '' }}">
                        <span class="language-flag">ðŸ‡¯ðŸ‡µ</span>
                        <span>æ—¥æœ¬èªž</span>
                    </a>
                    <a href="{{ path('app_change_locale', {locale: 'ko'}) }}" 
                       class="{{ app.request.locale == 'ko' ? 'active' : '' }}">
                        <span class="language-flag">ðŸ‡°ðŸ‡·</span>
                        <span>í•œêµ­ì–´</span>
                    </a>
                </div>
            </div>
        </div>

        {# Messages flash #}
        {% if app.flashes|length > 0 %}
            <div class="flash-messages">
                {% for type, messages in app.flashes %}
                    {% for message in messages %}
                        <div class="alert alert-{{ type }}">
                            {{ message|trans }}
                        </div>
                    {% endfor %}
                {% endfor %}
            </div>
        {% endif %}

        {# Contenu principal #}
        {% block body %}{% endblock %}
    </body>
</html>